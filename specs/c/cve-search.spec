%define  _unpackaged_files_terminate_build  1
%filter_from_requires /.*(lib)*/d
%filter_from_requires /.*(irc*/d
Name: 	  cve-search
Version:  2.2
Release:  alt2

Summary:  common vulnerability search and management
License:  Modified BSD license
Group:    Other 
Url: 	  https://github.com/cve-search/cve-search.git

Packager: Denis Medvedev <nbr@altlinux.org>

Source:   %name-%version.tar
Patch:    %name-%version-%release.patch

ExclusiveArch: x86_64

BuildRequires: python3-devel rpm-build-python3
BuildRequires: redis python3-module-pymongo python3-module-flask python3-module-flask-pymongo python3-module-flask-login python3-module-tornado python3-module-whoosh  python3-module-redis-py python3-module-redis_structures python3-module-dateutil  python3-module-passlib  python3-module-SleekXMPP python3-module-werkzeug python3-module-jinja2 python3-module-itsdangerous python3-module-click 

Requires: redis mongo mongo-server-mongod mongo-server-mongos python3-module-flask python3-module-flask-pymongo python3-module-flask-login python3-module-tornado python3-module-whoosh  python3-module-redis-py python3-module-redis_structures python3-module-dateutil  python3-module-passlib  python3-module-SleekXMPP python3-module-werkzeug python3-module-jinja2 python3-module-itsdangerous python3-module-click 



%description
A program to fetch and manage information about common software vulnerabilities

%prep
%setup
%patch -p1


%install
mkdir -p  %buildroot/%_bindir
cp -a bin/*  %buildroot/%_bindir
mkdir -p  %buildroot/%_sbindir
cp -a sbin/*  %buildroot/%_sbindir
mkdir -p  %buildroot/%_sysconfdir
cp -a etc/* %buildroot/%_sysconfdir
mkdir -p  %buildroot/%_docdir/%name-%version/doc
cp -a  doc/* %buildroot/%_docdir/%name-%version/doc
mkdir -p  %buildroot/%_docdir/%name-%version/test
cp -a  test %buildroot/%_docdir/%name-%version/test
mkdir -p  %buildroot/%_libexecdir/cve-search/web
cp -a  web %buildroot/%_libexecdir/cve-search/web
mkdir -p %buildroot/%_libexecdir/cve_search/lib
cp -a  lib %buildroot/%_libexecdir/cve_search/lib
cp LICENSE NEWS README.md requirements.txt %buildroot/%_docdir/%name-%version/doc




%files
%_bindir/*
%_sbindir/*
%_libexecdir/*
%_sysconfdir/*
%_docdir/%name-%version/*
# The package does not own its own docdir subdirectory.
# The line below is added by repocop to fix this bug in a straightforward way. 
# Another way is to rewrite the spec to use relative doc paths.
%dir %_docdir/cve-search-%version 


%changelog
* Wed Oct 11 2017 Denis Medvedev <nbr@altlinux.org> 2.2-alt2
- Fixed docdir using repocop's help

* Sun Apr 02 2017 Denis Medvedev <nbr@altlinux.org> 2.2-alt1
- Initial Sisyphus release
